<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Les 10 D√©fis de la Brasserie</title>
<style>
    body { font-family: Arial, sans-serif; background: #121212; color: #eee; text-align: center; margin: 0; padding: 0; display: flex; flex-direction: column; min-height: 100vh; }
    header { background: #1f1f1f; padding: 15px; font-size: 24px; font-weight: bold; }
    #menu { display: flex; flex-wrap: wrap; justify-content: center; background: #222; padding: 10px; }
    .game-btn { background: #4CAF50; border: none; color: white; margin: 5px; padding: 10px 15px; border-radius: 6px; cursor: pointer; flex: 1 1 140px; max-width: 150px; transition: background 0.3s; }
    .game-btn:hover:not(:disabled) { background: #45a049; }
    .game-btn:disabled { background: #555; cursor: not-allowed; opacity: 0.6; }
    #main-content { display: flex; flex: 1; flex-direction: column; justify-content: center; align-items: center; padding: 20px; }
    #game-container { padding: 20px; min-height: 300px; }
    #message { margin-top: 20px; font-size: 22px; color: yellow; font-weight: bold; }
    .answer-btn { background: #008CBA; margin: 10px; padding: 10px 20px; font-size: 18px; border-radius: 6px; border: none; cursor: pointer; transition: background 0.3s; }
    .answer-btn:hover { background: #007B9E; }
    input[type=text], input[type=number] { font-size: 18px; padding: 8px; width: 200px; border-radius: 6px; border: none; margin-top: 10px; }
    #reward-card { display: none; margin-top: 40px; text-align: center; }
    #reward-card p { font-size: 24px; color: #fff; margin-top: 20px; }
    #submit-form-btn { background: #4CAF50; color: white; border: none; padding: 15px 30px; font-size: 24px; border-radius: 8px; cursor: pointer; }
    #submit-form-btn:hover { background: #45a049; }
</style>
</head>
<body>

<header>
    Les 10 D√©fis de la Brasserie
</header>

<div id="menu"></div>

<div id="main-content">
    <div id="game-container">
        <h2>Bienvenue !</h2>
        <p>R√©ussissez les 10 d√©fis pour gagner votre r√©compense !</p>
    </div>
    <div id="message"></div>
    <div id="reward-card">
        <p>Un formulaire a √©t√© cr√©e!<br>Pour avoir une chance d'un menu complet gratuit , cliquez sur le bouton ci-dessous pour valider votre participation aupr√®s du formulaire.</p>
        <button id="submit-form-btn">R√©clamer ma r√©compense !</button>
    </div>
</div>

<script>
const menu = document.getElementById('menu');
const container = document.getElementById('game-container');
const message = document.getElementById('message');
const rewardCard = document.getElementById('reward-card');
const gamesStatus = {};

const games = [
    { id: 'calcul', name: "D√©fi 1 : Le Calcul", fn: jeuCalcul },
    { id: 'pendu', name: "D√©fi 2 : Le Pendu", fn: jeuPendu },
    { id: 'code', name: "D√©fi 3 : Le Code", fn: jeuCodeSecret },
    { id: 'tresor', name: "D√©fi 4 : Le Tr√©sor", fn: jeuChasseAuTresor },
    { id: 'simpleClic', name: "D√©fi 5 : La Bonne Case", fn: jeuSimpleClic },
    { id: 'suite', name: "D√©fi 6 : La Suite", fn: jeuSuiteNombres },
    { id: 'compteur', name: "D√©fi 7 : Le Compteur", fn: jeuCompteur },
    { id: 'chiffres', name: "D√©fi 8 : Les Chiffres", fn: jeuChiffres },
    { id: 'poids', name: "D√©fi 9 : Le Poids", fn: jeuPoids },
    { id: 'paires', name: "D√©fi 10 : Les Paires", fn: jeuPairesCouleurs },
];

function checkAllGamesCompleted() {
    const allCompleted = games.every(g => gamesStatus[g.id]);
    if (allCompleted) {
        container.innerHTML = '<h2>Tous les d√©fis sont r√©ussis !</h2>';
        message.textContent = '';
        rewardCard.style.display = 'block';
    }
}

document.getElementById('submit-form-btn').onclick = () => {
    // URL de soumission du formulaire Google
    const formUrl = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLScF0UW58m8EImcClloWz9sdxjwLLRMh5eDWWscHNBbl2klrVw/formResponse';
    
    // Cr√©er un formulaire temporaire
    const form = document.createElement('form');
    form.action = formUrl;
    form.method = 'post';
    form.target = '_blank'; // Ouvre l'URL dans un nouvel onglet
    
    // Ajoutez des champs de formulaire si n√©cessaire, par exemple un champ cach√©
    // form.innerHTML = '<input type="hidden" name="entry.123456789" value="jeu termin√©" />';
    
    document.body.appendChild(form);
    form.submit();
    document.body.removeChild(form);
    
    // Affiche un message pour le joueur apr√®s l'envoi
    rewardCard.innerHTML = '<p>Merci, √ßa a bien √©t√© enregistr√©. Nous vous contacterons !</p>';
};

function completeGame(gameId) {
    if (!gamesStatus[gameId]) {
        gamesStatus[gameId] = true;
        const btn = document.querySelector(`.game-btn[data-id="${gameId}"]`);
        if (btn) {
            btn.disabled = true;
            btn.style.backgroundColor = '#2c5d2e';
        }
        checkAllGamesCompleted();
    }
}

function resetGameArea() {
    container.innerHTML = '';
    message.textContent = '';
    rewardCard.style.display = 'none';
}

games.forEach(g => {
    const btn = document.createElement('button');
    btn.textContent = g.name;
    btn.classList.add('game-btn');
    btn.setAttribute('data-id', g.id);
    btn.onclick = () => {
        if (!gamesStatus[g.id]) {
            resetGameArea();
            g.fn(g.id);
        }
    };
    menu.appendChild(btn);
});

// --- D√©finition des jeux ---

// 1. Le Calcul
function jeuCalcul(id) {
    const a = Math.floor(Math.random() * 10) + 5;
    const b = Math.floor(Math.random() * 10) + 5;
    const c = a * b;
    container.innerHTML = `
        <h2>D√©fi 1 : Le Calcul</h2>
        <p>Combien font ${a} x ${b} ?</p>
        <input type="number" id="calculInput" />
        <br/><br/>
        <button class="answer-btn" onclick="checkAnswer(${c}, document.getElementById('calculInput').value, '${id}')">Valider</button>
    `;
}

// 2. Le Pendu
function jeuPendu(id) {
    const mots = ['BRASSIERE', 'DEFI', 'RECOMPENSE', 'GRATUIT', 'PROMOTION', 'MENU'];
    const motSecret = mots[Math.floor(Math.random() * mots.length)];
    let motAffiche = '_'.repeat(motSecret.length);
    let erreurs = 0;
    const maxErreurs = 6;
    lettresUtilisees = new Set();
    container.innerHTML = `
        <h2>D√©fi 2 : Le Pendu</h2>
        <h3 id="mot-pendu">${motAffiche}</h3>
        <p>Nombre d'erreurs: <span id="erreurs">0</span> / ${maxErreurs}</p>
        <p>Lettres d√©j√† utilis√©es: <span id="lettres-utilisee"></span></p>
        <input type="text" id="lettreInput" maxlength="1" placeholder="Tape une lettre" />
        <button class="answer-btn" id="penduBtn">Valider</button>
    `;
    document.getElementById('penduBtn').onclick = () => {
        const lettre = document.getElementById('lettreInput').value.toUpperCase();
        document.getElementById('lettreInput').value = '';
        if (!lettre || lettresUtilisees.has(lettre)) return;
        lettresUtilisees.add(lettre);
        document.getElementById('lettres-utilisee').textContent = [...lettresUtilisees].join(', ');
        if (motSecret.includes(lettre)) {
            let nouveauMot = '';
            for (let i = 0; i < motSecret.length; i++) {
                nouveauMot += motSecret[i] === lettre ? lettre : motAffiche[i];
            }
            motAffiche = nouveauMot;
            document.getElementById('mot-pendu').textContent = motAffiche;
            if (!motAffiche.includes('_')) {
                message.textContent = 'Bravo, tu as gagn√© !';
                completeGame(id);
            }
        } else {
            erreurs++;
            document.getElementById('erreurs').textContent = erreurs;
            if (erreurs >= maxErreurs) {
                message.textContent = `Dommage, tu as perdu ! Le mot √©tait : ${motSecret}`;
            }
        }
    };
}

// 3. Le Code Secret
function jeuCodeSecret(id) {
    const secret = [Math.floor(Math.random() * 3) + 1, Math.floor(Math.random() * 3) + 1];
    let tentatives = 0;
    container.innerHTML = `
        <h2>D√©fi 3 : Le Code Secret</h2>
        <p>Devine la s√©quence de 2 nombres entre 1 et 3.</p>
        <input type="number" id="guess1" min="1" max="3" />
        <input type="number" id="guess2" min="1" max="3" />
        <br/><br/>
        <button class="answer-btn" id="guessBtn">Valider</button>
    `;
    document.getElementById('guessBtn').onclick = () => {
        const guess = [parseInt(document.getElementById('guess1').value), parseInt(document.getElementById('guess2').value)];
        if (guess.some(isNaN)) { message.textContent = "Entre 2 nombres valides."; return; }
        tentatives++;
        if (guess[0] === secret[0] && guess[1] === secret[1]) {
            message.textContent = `Bravo ! Tu as trouv√© le code en ${tentatives} tentatives !`;
            completeGame(id);
        } else {
            message.textContent = `Faux, essaie encore.`;
        }
    };
}

// 4. La Chasse au Tr√©sor
function jeuChasseAuTresor(id) {
    const emojis = ['üíé', 'üí∞', 'üîë', 'üß≠'];
    const tresor = 'üí∞';
    const shuffledEmojis = emojis.sort(() => Math.random() - 0.5);
    container.innerHTML = `<h2>D√©fi 4 : Chasse au Tr√©sor</h2><p>Trouve le tr√©sor üí∞</p>`;
    shuffledEmojis.forEach(e => {
        const btn = document.createElement('button');
        btn.textContent = e;
        btn.style.fontSize = '40px';
        btn.style.margin = '10px';
        btn.onclick = () => {
            if (e === tresor) {
                message.textContent = 'F√©licitations, tu as trouv√© le tr√©sor !';
                completeGame(id);
            } else {
                message.textContent = 'Dommage, ce n\'est pas le tr√©sor. Essaie encore !';
            }
        };
        container.appendChild(btn);
    });
}

// 5. La Bonne Case
function jeuSimpleClic(id) {
    const mots = ['BRASSIERE', 'DEFI', 'BONJOUR', 'GARE'];
    const motCorrect = mots[Math.floor(Math.random() * mots.length)];
    const motsMelanges = mots.sort(() => Math.random() - 0.5);
    container.innerHTML = `
        <h2>D√©fi 5 : La Bonne Case</h2>
        <p>Cliquez sur la case o√π est √©crit le mot : **${motCorrect}**</p>
        <div id="cases-mots" style="display: flex; flex-wrap: wrap; justify-content: center;"></div>
    `;
    const casesDiv = document.getElementById('cases-mots');
    motsMelanges.forEach(mot => {
        const btn = document.createElement('button');
        btn.textContent = mot;
        btn.classList.add('answer-btn');
        btn.style.padding = '20px 30px';
        btn.style.fontSize = '20px';
        btn.onclick = () => {
            if (mot === motCorrect) {
                message.textContent = 'Bravo, vous avez trouv√© la bonne case !';
                completeGame(id);
            } else {
                message.textContent = 'Faux, essaie encore.';
            }
        };
        casesDiv.appendChild(btn);
    });
}

// 6. La Suite de Nombres
function jeuSuiteNombres(id) {
    const start = Math.floor(Math.random() * 5) + 1;
    const diff = Math.floor(Math.random() * 3) + 2;
    const suite = [start, start + diff, start + diff * 2, start + diff * 3];
    const next = start + diff * 4;
    container.innerHTML = `
        <h2>D√©fi 6 : La Suite</h2>
        <p>Quel est le prochain nombre dans cette suite ?</p>
        <h3>${suite.join(', ')}, ?</h3>
        <input type="number" id="suiteInput" />
        <br/><br/>
        <button class="answer-btn" onclick="checkAnswer(${next}, document.getElementById('suiteInput').value, '${id}')">Valider</button>
    `;
}

// 7. Le Compteur
function jeuCompteur(id) {
    const chiffreCible = Math.floor(Math.random() * 5) + 3;
    let compteur = 0;
    container.innerHTML = `
        <h2>D√©fi 7 : Le Compteur</h2>
        <p>Cliquez sur le bouton jusqu'√† atteindre le chiffre **${chiffreCible}**.</p>
        <h3 id="compteur-chiffre">0</h3>
        <button class="answer-btn" onclick="updateCompteur('${id}', ${chiffreCible})">Cliquez ici !</button>
    `;
    window.updateCompteur = (gameId, target) => {
        compteur++;
        document.getElementById('compteur-chiffre').textContent = compteur;
        if (compteur === target) {
            message.textContent = 'Bravo, vous avez atteint le bon chiffre !';
            completeGame(gameId);
        } else if (compteur > target) {
            message.textContent = 'Oups, vous avez d√©pass√© le chiffre ! Recommencez le d√©fi.';
            compteur = 0;
            document.getElementById('compteur-chiffre').textContent = '0';
        }
    };
}

// 8. Les Chiffres
function jeuChiffres(id) {
    const chiffres = [1, 2, 3, 4, 5, 6, 7, 8, 9];
    const bonChiffre = 7;
    container.innerHTML = `<h2>D√©fi 8 : Le bon Chiffre</h2><p>Clique sur le chiffre 7</p>`;
    chiffres.sort(() => Math.random() - 0.5);
    chiffres.forEach(chiffre => {
        const btn = document.createElement('button');
        btn.textContent = chiffre;
        btn.style.fontSize = '24px';
        btn.style.margin = '10px';
        btn.onclick = () => {
            if (chiffre === bonChiffre) {
                message.textContent = 'Bravo, tu as trouv√© le bon chiffre !';
                completeGame(id);
            } else {
                message.textContent = 'Non, ce n\'est pas le bon. Essaie encore !';
            }
        };
        container.appendChild(btn);
    });
}

// 9. Le Poids
function jeuPoids(id) {
    const objets = [
        { nom: "une cuill√®re", poids: "20g" },
        { nom: "une chaise", poids: "5kg" },
    ];
    const obj = objets[Math.floor(Math.random() * objets.length)];
    container.innerHTML = `
        <h2>D√©fi 9 : Le Poids</h2>
        <p>Quel est le poids approximatif d'**${obj.nom}** ?</p>
        <input type="text" id="poidsInput" placeholder="ex: 20g ou 5kg" />
        <br/><br/>
        <button class="answer-btn" onclick="checkStringAnswer('${obj.poids}', document.getElementById('poidsInput').value, '${id}')">Valider</button>
    `;
}

// 10. Les Paires de Couleurs
function jeuPairesCouleurs(id) {
    const couleurs = ['red', 'red', 'blue', 'blue', 'green', 'green', 'yellow', 'yellow'];
    couleurs.sort(() => Math.random() - 0.5);
    let first = null;
    let second = null;
    let matched = 0;
    container.innerHTML = `<h2>D√©fi 10 : Les Paires</h2><p>Retrouve toutes les paires de couleurs</p>`;
    couleurs.forEach((couleur) => {
        const btn = document.createElement('button');
        btn.style.width = '60px';
        btn.style.height = '60px';
        btn.style.margin = '10px';
        btn.style.backgroundColor = 'gray';
        btn.onclick = () => {
            if (btn.style.backgroundColor !== 'gray' || second) return;
            btn.style.backgroundColor = couleur;
            if (!first) {
                first = btn;
            } else {
                second = btn;
                if (first.style.backgroundColor === second.style.backgroundColor) {
                    matched += 2;
                    first = null;
                    second = null;
                    if (matched === couleurs.length) {
                        message.textContent = `Bravo ! Tu as trouv√© toutes les paires !`;
                        completeGame(id);
                    }
                } else {
                    setTimeout(() => {
                        first.style.backgroundColor = 'gray';
                        second.style.backgroundColor = 'gray';
                        first = null;
                        second = null;
                    }, 1000);
                }
            }
        };
        container.appendChild(btn);
    });
}

// Fonction pour v√©rifier la r√©ponse pour les nombres
function checkAnswer(expected, actual, id) {
    const actualFormatted = parseInt(actual);
    if (actualFormatted == expected) {
        message.textContent = 'Bravo ! C\'est la bonne r√©ponse.';
        completeGame(id);
    } else {
        message.textContent = 'Faux, essaie encore.';
    }
}

// Fonction pour v√©rifier la r√©ponse pour les cha√Ænes de caract√®res
function checkStringAnswer(expected, actual, id) {
    const actualFormatted = actual.toLowerCase().trim();
    const expectedFormatted = expected.toLowerCase().replace(/[']/g, '');
    if (actualFormatted.includes(expectedFormatted) && actualFormatted.length > 2) {
        message.textContent = 'Bravo ! C\'est la bonne r√©ponse.';
        completeGame(id);
    } else {
        message.textContent = 'Faux, essaie encore.';
    }
}
</script>
</body>
</html>
